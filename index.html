<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆè‚¥å®éªŒå­¦æ ¡20çº§2ç­å®˜æ–¹ç½‘ç«™</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Arial','Microsoft YaHei',sans-serif}
        body{line-height:1.6;color:#333;background:#f5f7fa}
        .container{max-width:1200px;margin:0 auto;padding:0 20px}
        .section{padding:60px 0}
        .navbar{background:#fff;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:fixed;width:100%;top:0;z-index:1000}
        .nav-container{max-width:1200px;margin:0 auto;padding:15px 20px;display:flex;justify-content:space-between;align-items:center}
        .logo-container{display:flex;align-items:center;gap:15px}
        .logo{height:40px;width:auto;border-radius:50%}
        .class-name{font-size:1.5rem;font-weight:bold;color:#2c3e50}
        .nav-links{display:flex;gap:30px}
        .nav-links a{text-decoration:none;color:#555;font-weight:500;transition:color .3s}
        .nav-links a:hover{color:#3498db}
        .hero{background:linear-gradient(135deg,#3498db,#2c3e50);color:white;padding:150px 0 100px;text-align:center;margin-top:70px}
        .hero-content h1{font-size:2.8rem;margin-bottom:20px}
        .hero-content p{font-size:1.2rem;margin-bottom:30px;opacity:.9}
        .btn{display:inline-block;background:#e74c3c;color:white;padding:12px 30px;border-radius:30px;text-decoration:none;font-weight:bold;border:none;cursor:pointer;transition:background .3s}
        .btn:hover{background:#c0392b}
        .btn-small{padding:6px 12px;font-size:0.8rem}
        .btn-secondary{background:#3498db}
        .btn-secondary:hover{background:#2980b9}
        .about-content{display:grid;grid-template-columns:2fr 1fr;gap:50px;margin-top:40px}
        @media(max-width:768px){.about-content{grid-template-columns:1fr}}
        .stat{text-align:center;padding:30px;background:white;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
        .stat i{font-size:2.5rem;color:#3498db;margin-bottom:15px}
        .section-subtitle{text-align:center;color:#666;margin-bottom:40px}
        .visitor-form{max-width:500px;margin:0 auto 50px;background:white;padding:30px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
        .visitor-form input,.visitor-form textarea{width:100%;padding:12px;margin-bottom:15px;border:2px solid #ddd;border-radius:5px;font-size:16px}
        .visitor-form input:focus,.visitor-form textarea:focus{border-color:#3498db;outline:none}
        .form-note{font-size:0.9rem;color:#666;margin-top:10px;text-align:center}
        .visitors-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:20px;margin-top:30px}
        @media(max-width:768px){.visitors-list{grid-template-columns:1fr}}
        .visitor-card{background:white;padding:20px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.1);text-align:center;position:relative}
        .visitor-card h4{color:#2c3e50;margin-bottom:10px}
        .visitor-card p{color:#666;font-size:0.9rem}
        .visitor-card .time{font-size:0.8rem;color:#999;margin-top:10px}
        .no-visitors{text-align:center;padding:40px;color:#888;font-style:italic}
        .delete-btn{position:absolute;top:5px;right:5px;background:none;border:none;color:#e74c3c;cursor:pointer;font-size:0.8rem;opacity:0.7}
        .delete-btn:hover{opacity:1}
        footer{background:#2c3e50;color:white;padding:40px 0;text-align:center}
        .footer-content{display:flex;flex-direction:column;align-items:center;gap:20px}
        .footer-logo{display:flex;align-items:center;gap:15px}
        .footer-logo-img{height:30px;width:auto;border-radius:50%}
        .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:30px;margin-top:40px}
        .feature{text-align:center;padding:25px;background:white;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.05)}
        .feature i{font-size:2.5rem;color:#3498db;margin-bottom:15px}
        @media(max-width:768px){.nav-links{display:none}.hero-content h1{font-size:2rem}}
        
        /* ç™»å½•é¡µé¢æ ·å¼ */
        .login-page{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#3498db,#2c3e50);display:flex;justify-content:center;align-items:center;z-index:2000;transition:opacity .5s}
        .login-container{background:white;padding:40px;border-radius:15px;box-shadow:0 15px 35px rgba(0,0,0,0.2);max-width:400px;width:90%;text-align:center}
        .login-form h2{margin-bottom:30px;color:#2c3e50}
        .login-form input{width:100%;padding:12px;margin-bottom:20px;border:2px solid #ddd;border-radius:5px;font-size:16px}
        .login-form input:focus{border-color:#3498db}
        .login-error{color:#e74c3c;margin-bottom:15px;font-size:0.9rem;min-height:20px}
        .login-info{font-size:0.8rem;color:#666;margin-top:20px;background:#f8f9fa;padding:10px;border-radius:5px}
        
        /* æ–°å¢åŠŸèƒ½æ ·å¼ */
        .user-badge{display:inline-block;padding:2px 8px;border-radius:12px;font-size:0.7rem;font-weight:bold;margin-left:8px}
        .badge-admin{background:#e74c3c;color:white}
        .badge-teacher{background:#3498db;color:white}
        .badge-student{background:#2ecc71;color:white}
        .badge-guest{background:#95a5a6;color:white}
        .notifications{max-width:800px;margin:0 auto}
        .notification-card{background:white;padding:20px;margin-bottom:15px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.1);border-left:4px solid #3498db}
        .notification-card.important{border-left-color:#e74c3c}
        .notification-header{display:flex;justify-content:space-between;margin-bottom:10px}
        .notification-title{font-weight:bold;color:#2c3e50}
        .notification-time{font-size:0.8rem;color:#999}
        .tabs{display:flex;gap:10px;margin-bottom:30px;flex-wrap:wrap}
        .tab{background:#eee;padding:10px 20px;border-radius:5px;cursor:pointer;transition:all .3s}
        .tab:hover{background:#ddd}
        .tab.active{background:#3498db;color:white}
        .tab-content{display:none}
        .tab-content.active{display:block}
        .album-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;margin-top:20px}
        .album-item{position:relative;border-radius:8px;overflow:hidden;height:150px}
        .album-item img{width:100%;height:100%;object-fit:cover}
        .album-item:hover{transform:scale(1.05);transition:transform .3s}
        .vote-options{margin:20px 0}
        .vote-option{background:#f8f9fa;padding:15px;margin-bottom:10px;border-radius:8px;display:flex;justify-content:space-between;align-items:center}
        .vote-progress{height:10px;background:#e0e0e0;border-radius:5px;margin-top:5px;overflow:hidden}
        .vote-bar{height:100%;background:#3498db;transition:width .3s}
        .grade-box{background:white;padding:20px;border-radius:10px;margin-bottom:15px;box-shadow:0 3px 10px rgba(0,0,0,0.1)}
        .grade-header{display:flex;justify-content:space-between;margin-bottom:10px}
        .grade-title{font-weight:bold}
        .grade-score{color:#e74c3c;font-weight:bold}
        .calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;margin-top:20px}
        .calendar-day{background:white;padding:10px;text-align:center;border-radius:5px;min-height:60px}
        .calendar-day.today{background:#3498db;color:white}
        .calendar-event{font-size:0.7rem;background:#e3f2fd;padding:2px 5px;border-radius:3px;margin-top:5px}
        
        /* æµç•…åº¦ä¼˜åŒ– */
        html{scroll-behavior:smooth}
        .visitor-card,.stat,.feature,.notification-card{transition:transform .2s,box-shadow .2s}
        .visitor-card:hover,.stat:hover,.feature:hover,.notification-card:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,0,0,0.12)}
        #scrollTopBtn{position:fixed;bottom:30px;right:30px;width:50px;height:50px;border-radius:50%;background:#3498db;color:white;border:none;cursor:pointer;font-size:1.5rem;display:none;z-index:1000;box-shadow:0 3px 10px rgba(0,0,0,0.3);transition:opacity .3s}
        #scrollTopBtn:hover{opacity:.9}
        .fade-in{animation:fadeIn .5s ease-out}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    </style>
</head>
<body>
    <!-- ç™»å½•é¡µé¢ -->
    <div id="loginPage" class="login-page">
        <div class="login-container">
            <div class="login-form">
                <h2><i class="fas fa-user-graduate"></i> ç™»å½•ï¼Œè®¿é—®ç¾å¥½ä¸–ç•Œï¼</h2>
                <input type="text" id="loginUsername" placeholder="ç”¨æˆ·å" autocomplete="off">
                <input type="password" id="loginPassword" placeholder="å¯†ç " autocomplete="off">
                <div id="loginError" class="login-error"></div>
                <button onclick="checkLogin()" class="btn">ç™»å½•</button>
                <div class="login-info">
                    <p>è¯·è”ç³»ç®¡ç†å‘˜è·å–è´¦å·ä¿¡æ¯</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸»ç½‘ç«™å†…å®¹ -->
    <div id="mainContent" style="display:none;">
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo-container">
                    <img src="class-badge.png" alt="ç­å¾½" class="logo" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0NSIgZmlsbD0iIzM0OThkYiIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5YiG5LqrPC90ZXh0Pjwvc3ZnPg=='">
                    <span class="class-name">åˆè‚¥å®éªŒå­¦æ ¡20çº§2ç­å®˜æ–¹ç½‘ç«™</span>
                    <span style="font-size:0.9rem;color:#666;margin-left:10px;">
                        å·²ç™»å½•è´¦å·: <span id="loggedInUser">æˆå‘˜</span>
                        <span id="userBadge" class="user-badge"></span>
                    </span>
                </div>
                <div class="nav-links">
                    <a href="#home">é¦–é¡µ</a>
                    <a href="#about">å…³äºæˆ‘ä»¬</a>
                    <a href="#notices">ç­çº§é€šçŸ¥</a>
                    <a href="#features">ç­çº§ç‰¹è‰²</a>
                    <a href="#contact">ç•™è¨€æ¿</a>
                    <a href="#functions">æ›´å¤šåŠŸèƒ½</a>
                    <a href="#" onclick="logout()" style="color:#e74c3c"><i class="fas fa-sign-out-alt"></i> é€€å‡º</a>
                </div>
            </div>
        </nav>

        <section id="home" class="hero fade-in">
            <div class="hero-content">
                <h1>æ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„ç­çº§</h1>
                <p>å›¢ç»“ã€å¥‹è¿›ã€æ±‚çŸ¥ã€æˆé•¿</p>
                <a href="#about" class="btn">äº†è§£æ›´å¤š</a>
            </div>
        </section>

        <section id="about" class="section">
            <div class="container">
                <h2>å…³äºæˆ‘ä»¬</h2>
                <div class="about-content">
                    <div class="about-text">
                        <h3>ç­çº§ç®€ä»‹</h3>
                        <p>æˆ‘ä»¬æ˜¯ä¸€ä¸ªå……æ»¡æ´»åŠ›ã€ç§¯æå‘ä¸Šçš„é›†ä½“ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸€èµ·å­¦ä¹ ï¼Œä¸€èµ·æˆé•¿ï¼Œå…±åŒåˆ›é€ ç¾å¥½çš„å›å¿†ã€‚</p>
                        <h3>ç­çº§å®£è¨€</h3>
                        <p>ä»¥æ¢¦ä¸ºé©¬ï¼Œä¸è´ŸéŸ¶åï¼›ä»¥å‹¤ä¸ºå¾„ï¼Œå‹‡æ”€é«˜å³°ã€‚</p>
                        <h3>ç­çº§ç›®æ ‡</h3>
                        <p>æˆä¸ºå­¦æ ¡æœ€ä¼˜ç§€çš„ç­çº§ï¼ŒåŸ¹å…»å…¨é¢å‘å±•çš„å­¦ç”Ÿã€‚</p>
                    </div>
                    <div class="about-stats">
                        <div class="stat fade-in" style="animation-delay:0.1s">
                            <i class="fas fa-users"></i>
                            <h3>ç­çº§äººæ•°</h3>
                            <p>43äºº</p>
                        </div>
                        <div class="stat fade-in" style="animation-delay:0.2s">
                            <i class="fas fa-graduation-cap"></i>
                            <h3>æˆç«‹æ—¶é—´</h3>
                            <p>2020å¹´9æœˆ</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç­çº§é€šçŸ¥ -->
        <section id="notices" class="section bg-light">
            <div class="container">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:30px">
                    <h2>ç­çº§é€šçŸ¥</h2>
                    <button id="addNoticeBtn" class="btn btn-small" onclick="showNoticeForm()" style="display:none">
                        <i class="fas fa-plus"></i> å‘å¸ƒé€šçŸ¥
                    </button>
                </div>
                
                <div id="noticeForm" class="visitor-form" style="display:none">
                    <input type="text" id="noticeTitle" placeholder="é€šçŸ¥æ ‡é¢˜" maxlength="50">
                    <textarea id="noticeContent" placeholder="é€šçŸ¥å†…å®¹" rows="4" maxlength="200"></textarea>
                    <div style="display:flex;gap:10px">
                        <button onclick="addNotice()" class="btn">å‘å¸ƒé€šçŸ¥</button>
                        <button onclick="hideNoticeForm()" class="btn btn-secondary">å–æ¶ˆ</button>
                    </div>
                </div>
                
                <div id="notificationsList" class="notifications">
                    <!-- é€šçŸ¥å†…å®¹åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </section>

        <!-- ç­çº§ç‰¹è‰² -->
        <section id="features" class="section">
            <div class="container">
                <h2>ç­çº§ç‰¹è‰²</h2>
                <div class="features">
                    <div class="feature fade-in" style="animation-delay:0.1s">
                        <i class="fas fa-heart"></i>
                        <h3>å›¢ç»“å‹çˆ±</h3>
                        <p>æˆ‘ä»¬åƒä¸€ä¸ªå¤§å®¶åº­ï¼Œäº’å¸®äº’åŠ©ï¼Œå…±åŒè¿›æ­¥ã€‚</p>
                    </div>
                    <div class="feature fade-in" style="animation-delay:0.2s">
                        <i class="fas fa-lightbulb"></i>
                        <h3>åˆ›æ–°æ€ç»´</h3>
                        <p>é¼“åŠ±åˆ›æ–°ï¼ŒåŸ¹å…»è§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚</p>
                    </div>
                    <div class="feature fade-in" style="animation-delay:0.3s">
                        <i class="fas fa-trophy"></i>
                        <h3>è£èª‰æˆå°±</h3>
                        <p>å¤šæ¬¡è·å¾—å­¦æ ¡è£èª‰å’Œç«èµ›å¥–é¡¹ã€‚</p>
                    </div>
                    <div class="feature fade-in" style="animation-delay:0.4s">
                        <i class="fas fa-book"></i>
                        <h3>çƒ­çˆ±å­¦ä¹ </h3>
                        <p>è¥é€ æµ“åšçš„å­¦ä¹ æ°›å›´ï¼Œè¿½æ±‚å“è¶Šã€‚</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç•™è¨€æ¿ -->
        <section id="contact" class="section bg-light">
            <div class="container">
                <h2>ç•™è¨€æ¿</h2>
                <p class="section-subtitle">ç•™ä¸‹ä½ çš„åå­—ï¼Œè®©æˆ‘ä»¬çŸ¥é“ä½ æ¥è¿‡ï¼</p>
                
                <div class="visitor-form fade-in">
                    <input type="text" id="visitorName" placeholder="è¯·è¾“å…¥ä½ çš„åå­—" maxlength="20">
                    <input type="text" id="visitorMessage" placeholder="æƒ³è¯´ç‚¹ä»€ä¹ˆï¼Ÿï¼ˆå¯é€‰ï¼‰" maxlength="50">
                    <button onclick="addVisitor()" class="btn">ç•™ä¸‹æˆ‘çš„åå­—</button>
                    <p class="form-note">æ³¨æ„ï¼šç•™è¨€ä»…ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œåˆ·æ–°é¡µé¢ä¼šæ¸…ç©º</p>
                    <div style="display:flex;gap:10px;justify-content:center;margin-top:15px">
                        <button onclick="clearAllVisitors()" class="btn btn-small">æ¸…ç©ºç•™è¨€</button>
                        <button onclick="copySiteLink()" class="btn btn-small">å¤åˆ¶é“¾æ¥</button>
                    </div>
                </div>

                <div class="visitors-container">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                        <h3>æœ€è¿‘è®¿å®¢</h3>
                        <div style="color:#666;font-size:0.9rem">
                            å…± <span id="totalMessages">0</span> æ¡ç•™è¨€
                        </div>
                    </div>
                    <div id="visitorsList" class="visitors-list"></div>
                </div>
            </div>
        </section>

        <!-- æ›´å¤šåŠŸèƒ½ -->
        <section id="functions" class="section">
            <div class="container">
                <h2>æ›´å¤šåŠŸèƒ½</h2>
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('birthday')">ç”Ÿæ—¥æé†’</div>
                    <div class="tab" onclick="switchTab('calendar')">ç­çº§æ—¥å†</div>
                    <div class="tab" onclick="switchTab('album')">ç­çº§ç›¸å†Œ</div>
                    <div class="tab" onclick="switchTab('vote')">ç­çº§æŠ•ç¥¨</div>
                </div>
                
                <div id="birthday" class="tab-content active">
                    <h3>æœ¬æœˆå¯¿æ˜Ÿ</h3>
                    <div id="birthdayList" class="visitors-list"></div>
                </div>
                
                <div id="calendar" class="tab-content">
                    <h3>ç­çº§æ—¥å†</h3>
                    <div id="calendarView" class="calendar"></div>
                </div>
                
                <div id="album" class="tab-content">
                    <h3>ç­çº§ç›¸å†Œ</h3>
                    <div id="albumList" class="album-grid"></div>
                </div>
                
                <div id="vote" class="tab-content">
                    <h3>ç­çº§æŠ•ç¥¨</h3>
                    <div id="voteList" class="visitor-form"></div>
                </div>
            </div>
        </section>

        <footer>
            <div class="container">
                <div class="footer-content">
                    <div class="footer-logo">
                        <img src="class-badge.png" alt="ç­å¾½" class="footer-logo-img" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0NSIgZmlsbD0iIzM0OThkYiIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5YiG5LqrPC90ZXh0Pjwvc3ZnPg=='">
                        <p>æˆ‘ä»¬çš„ç­çº§ç½‘ç«™</p>
                    </div>
                    <p>&copy; <span id="currentYear">2026</span> è¿™ç­æœ€ç‰›ç¨‹åºçŒ¿. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
                </div>
            </div>
        </footer>

        <!-- æ»šåŠ¨åˆ°é¡¶éƒ¨æŒ‰é’® -->
        <button id="scrollTopBtn" onclick="scrollToTop()">â†‘</button>
    </div>

    <script>
        // ================================================
        // ã€ç³»ç»Ÿæ ¸å¿ƒé…ç½®ã€‘
        // ================================================
        
        // é¢„è®¾è´¦å·é…ç½®ï¼ˆåŒ…å«ç­‰çº§ä¿¡æ¯ï¼‰
        const PRESET_ACCOUNTS = [
            { username: "ç®¡ç†å­™", password: "SunYiYangadmin", displayName: "ç®¡ç†å‘˜", level: 5 },
            { username: "å§šè€å¸ˆ", password: "teacherY", displayName: "ç­ä¸»ä»»", level: 4 },
            { username: "é’±æ€å®‡", password: "monitor123", displayName: "é’±æ€å®‡ã€ç­çº§äººä¸Šäººï¼Œæ¯”äººé«˜ä¸€ç­‰ã€‘", level: 3 },
            { username: "æ¸¸å®¢", password: "123456", displayName: "æ¸¸å®¢æ¨¡å¼", level: 2 }
        ];
        
        // ç­‰çº§æƒé™æ˜ å°„
        const LEVEL_PERMISSIONS = {
            5: { name: "ç®¡ç†å‘˜", badge: "badge-admin", color: "#e74c3c", canManage: true },
            4: { name: "æ•™å¸ˆ", badge: "badge-teacher", color: "#3498db", canManage: true },
            3: { name: "ç­å¹²éƒ¨", badge: "badge-student", color: "#f39c12", canManage: false },
            2: { name: "å­¦ç”Ÿ", badge: "badge-student", color: "#2ecc71", canManage: false }
        };
        
        // ç”Ÿæ—¥æ•°æ®ç¤ºä¾‹
        const BIRTHDAY_DATA = [
            { name: "å­™äº¦é˜³", month: 9, day: 27 },
            { name: "æå´”å¸Œ", month: 9, day: 28 },
            { name: "ç­‰å¾…æŠ•æ”¾å†…å®¹", month: 1, day: 1 },
            { name: "ç­‰å¾…æŠ•æ”¾å†…å®¹", month: 1, day: 1 }
        ];
        
        // ================================================
        // ã€æ ¸å¿ƒç³»ç»Ÿç±»ã€‘
        // ================================================
        
        class SystemManager {
            constructor() {
                this.loginKey = 'class_login_status';
                this.userKey = 'class_logged_in_user';
                this.levelKey = 'user_level';
                this.checkAutoLogin();
            }
            
            checkAutoLogin() {
                const isLoggedIn = localStorage.getItem(this.loginKey);
                const loggedInUser = localStorage.getItem(this.userKey);
                const userLevel = localStorage.getItem(this.levelKey);
                
                if (isLoggedIn === 'true' && loggedInUser && userLevel) {
                    this.showMainContent(loggedInUser, parseInt(userLevel));
                }
            }
            
            login(username, password) {
                const account = PRESET_ACCOUNTS.find(acc => 
                    acc.username === username && acc.password === password
                );
                
                if (account) {
                    localStorage.setItem(this.loginKey, 'true');
                    localStorage.setItem(this.userKey, account.displayName);
                    localStorage.setItem(this.levelKey, account.level.toString());
                    this.showMainContent(account.displayName, account.level);
                    return true;
                }
                return false;
            }
            
            logout() {
                if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                    localStorage.removeItem(this.loginKey);
                    localStorage.removeItem(this.userKey);
                    localStorage.removeItem(this.levelKey);
                    this.showLoginPage();
                }
            }
            
            showMainContent(displayName, level) {
                document.getElementById('loginPage').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('mainContent').style.display = 'block';
                    
                    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
                    document.getElementById('loggedInUser').textContent = displayName;
                    
                    // æ˜¾ç¤ºç­‰çº§å¾½ç« 
                    const badgeElement = document.getElementById('userBadge');
                    const permission = LEVEL_PERMISSIONS[level];
                    if (permission) {
                        badgeElement.className = `user-badge ${permission.badge}`;
                        badgeElement.textContent = permission.name;
                        badgeElement.style.backgroundColor = permission.color;
                    }
                    
                    // æ ¹æ®æƒé™æ˜¾ç¤ºç®¡ç†æŒ‰é’®
                    if (permission.canManage) {
                        document.getElementById('addNoticeBtn').style.display = 'block';
                    }
                    
                    // æ˜¾ç¤ºé€šçŸ¥
                    this.showToast(`æ¬¢è¿å›æ¥ï¼Œ${displayName}ï¼`, 'success');
                    
                    // åˆå§‹åŒ–å„æ¨¡å—
                    visitorManager.init();
                    notificationManager.init();
                    birthdayManager.init();
                    calendarManager.init();
                    albumManager.init();
                    voteManager.init();
                    
                    // åˆå§‹åŒ–æ»šåŠ¨æŒ‰é’®
                    initScrollButton();
                    document.getElementById('currentYear').textContent = new Date().getFullYear();
                }, 500);
            }
            
            showLoginPage() {
                document.getElementById('loginPage').style.display = 'flex';
                setTimeout(() => {
                    document.getElementById('loginPage').style.opacity = '1';
                    document.getElementById('mainContent').style.display = 'none';
                    document.getElementById('loginUsername').value = '';
                    document.getElementById('loginPassword').value = '';
                    document.getElementById('loginError').textContent = '';
                }, 100);
            }
            
            showToast(message, type = 'info') {
                const toast = document.createElement('div');
                const colors = { success: '#2ecc71', warning: '#f39c12', info: '#3498db', error: '#e74c3c' };
                toast.innerHTML = `
                    <div style="
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: ${colors[type] || '#3498db'};
                        color: white;
                        padding: 15px 25px;
                        border-radius: 5px;
                        animation: slideIn 0.3s ease-out;
                        z-index: 1001;
                        box-shadow: 0 3px 10px rgba(0,0,0,0.2);
                    ">
                        <i class="fas fa-${type === 'success' ? 'check' : 'info'}-circle"></i> ${message}
                    </div>
                `;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.animation = 'slideOut 0.3s ease-out forwards';
                    setTimeout(() => toast.remove(), 300);
                }, 2000);
            }
            
            getCurrentLevel() {
                return parseInt(localStorage.getItem(this.levelKey) || '0');
            }
        }
        
        // ================================================
        // ã€ç•™è¨€ç®¡ç†å™¨ã€‘
        // ================================================
        
        class VisitorManager {
            constructor() {
                this.visitorsKey = 'class_visitors';
                this.maxVisitors = 20;
            }
            
            init() {
                this.displayVisitors();
                if (!this.getVisitors().length) {
                    this.addSampleVisitors();
                }
                this.updateStats();
            }
            
            addSampleVisitors() {
                const samples = [
                    { name: "ç­ä¸»ä»»", message: "åŒå­¦ä»¬åŠ æ²¹ï¼" },
                    { name: "å­™åŒå­¦", message: "ç­çº§ç½‘ç«™å¤ªæ£’äº†ï¼" },
                    { name: "å¼ åŒå­¦", message: "ä¸ºæˆ‘ä»¬çš„ç­çº§è‡ªè±ª" }
                ];
                samples.forEach(v => this.addVisitor(v.name, v.message, true));
            }
            
            addVisitor(name, message = '', isSample = false) {
                if (!isSample && !name.trim()) {
                    systemManager.showToast('è¯·è¾“å…¥ä½ çš„åå­—', 'warning');
                    return;
                }
                
                const visitor = {
                    name: name.trim().substr(0, 20),
                    message: message.trim().substr(0, 50),
                    time: new Date().toLocaleString('zh-CN'),
                    id: Date.now() + Math.random().toString(36).substr(2, 9)
                };
                
                let visitors = this.getVisitors();
                visitors.unshift(visitor);
                
                if (visitors.length > this.maxVisitors) {
                    visitors = visitors.slice(0, this.maxVisitors);
                }
                
                localStorage.setItem(this.visitorsKey, JSON.stringify(visitors));
                this.displayVisitors();
                
                if (!isSample) {
                    document.getElementById('visitorName').value = '';
                    document.getElementById('visitorMessage').value = '';
                    systemManager.showToast('ç•™è¨€æˆåŠŸï¼', 'success');
                }
            }
            
            deleteVisitor(id) {
                if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡ç•™è¨€å—ï¼Ÿ')) return;
                
                let visitors = this.getVisitors();
                visitors = visitors.filter(v => v.id !== id);
                localStorage.setItem(this.visitorsKey, JSON.stringify(visitors));
                this.displayVisitors();
                systemManager.showToast('å·²åˆ é™¤ç•™è¨€', 'info');
            }
            
            clearAllVisitors() {
                if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ç•™è¨€å—ï¼Ÿ')) {
                    localStorage.removeItem(this.visitorsKey);
                    this.displayVisitors();
                    systemManager.showToast('å·²æ¸…ç©ºç•™è¨€', 'info');
                }
            }
            
            getVisitors() {
                const visitors = localStorage.getItem(this.visitorsKey);
                return visitors ? JSON.parse(visitors) : [];
            }
            
            displayVisitors() {
                const visitors = this.getVisitors();
                const container = document.getElementById('visitorsList');
                
                if (!visitors.length) {
                    container.innerHTML = '<p class="no-visitors">è¿˜æ²¡æœ‰è®¿å®¢ï¼Œå¿«æ¥æˆä¸ºç¬¬ä¸€ä¸ªå§ï¼</p>';
                    this.updateStats();
                    return;
                }
                
                container.innerHTML = visitors.map(v => `
                    <div class="visitor-card fade-in">
                        <button class="delete-btn" onclick="visitorManager.deleteVisitor('${v.id}')" title="åˆ é™¤">
                            <i class="fas fa-times"></i>
                        </button>
                        <h4>${this.escapeHtml(v.name)}</h4>
                        ${v.message ? `<p>${this.escapeHtml(v.message)}</p>` : ''}
                        <div class="time">${v.time}</div>
                    </div>
                `).join('');
                this.updateStats();
            }
            
            updateStats() {
                document.getElementById('totalMessages').textContent = this.getVisitors().length;
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }
        
        // ================================================
        // ã€é€šçŸ¥ç®¡ç†å™¨ã€‘
        // ================================================
        
        class NotificationManager {
            constructor() {
                this.noticesKey = 'class_notices';
            }
            
            init() {
                this.displayNotices();
                if (!this.getNotices().length) {
                    this.addSampleNotices();
                }
            }
            
            addSampleNotices() {
                const samples = [
                    { title: "é‡è¦é€šçŸ¥", content: "ä»Šå¤©å‘è¯­æ–‡è¯•å·ï¼ï¼ï¼", time: "2026-01-06", important: true },
                    { title: "ç­çº§æ´»åŠ¨", content: "çƒ­çƒˆåº†ç¥ç­çº§å®˜ç½‘v8.0å…¬æµ‹å¼€å§‹ï¼", time: "2026-01-05", important: false }
                ];
                samples.forEach(notice => this.addNotice(notice.title, notice.content, true, notice.important));
            }
            
            addNotice(title, content, isSample = false, important = false) {
                if (!isSample && (!title.trim() || !content.trim())) {
                    systemManager.showToast('è¯·å¡«å†™å®Œæ•´é€šçŸ¥ä¿¡æ¯', 'warning');
                    return;
                }
                
                const notice = {
                    title: title.trim(),
                    content: content.trim(),
                    time: new Date().toLocaleDateString('zh-CN'),
                    id: Date.now(),
                    important: important
                };
                
                let notices = this.getNotices();
                notices.unshift(notice);
                localStorage.setItem(this.noticesKey, JSON.stringify(notices));
                this.displayNotices();
                
                if (!isSample) {
                    document.getElementById('noticeTitle').value = '';
                    document.getElementById('noticeContent').value = '';
                    hideNoticeForm();
                    systemManager.showToast('é€šçŸ¥å‘å¸ƒæˆåŠŸï¼', 'success');
                }
            }
            
            deleteNotice(id) {
                if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡é€šçŸ¥å—ï¼Ÿ')) return;
                
                let notices = this.getNotices();
                notices = notices.filter(n => n.id !== id);
                localStorage.setItem(this.noticesKey, JSON.stringify(notices));
                this.displayNotices();
                systemManager.showToast('å·²åˆ é™¤é€šçŸ¥', 'info');
            }
            
            getNotices() {
                const notices = localStorage.getItem(this.noticesKey);
                return notices ? JSON.parse(notices) : [];
            }
            
            displayNotices() {
                const notices = this.getNotices();
                const container = document.getElementById('notificationsList');
                
                if (!notices.length) {
                    container.innerHTML = '<p class="no-visitors">æš‚æ— é€šçŸ¥</p>';
                    return;
                }
                
                container.innerHTML = notices.map(n => `
                    <div class="notification-card ${n.important ? 'important' : ''}">
                        <div class="notification-header">
                            <div class="notification-title">${this.escapeHtml(n.title)}</div>
                            <div class="notification-time">${n.time}</div>
                        </div>
                        <p>${this.escapeHtml(n.content)}</p>
                        ${systemManager.getCurrentLevel() >= 4 ? 
                            `<button class="delete-btn" onclick="notificationManager.deleteNotice(${n.id})" title="åˆ é™¤é€šçŸ¥">
                                <i class="fas fa-trash"></i>
                            </button>` : ''}
                    </div>
                `).join('');
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }
        
        // ================================================
        // ã€ç”Ÿæ—¥ç®¡ç†å™¨ã€‘
        // ================================================
        
        class BirthdayManager {
            init() {
                this.displayBirthdays();
            }
            
            displayBirthdays() {
                const container = document.getElementById('birthdayList');
                const currentMonth = new Date().getMonth() + 1;
                
                const thisMonthBirthdays = BIRTHDAY_DATA.filter(b => b.month === currentMonth);
                
                if (!thisMonthBirthdays.length) {
                    container.innerHTML = '<p class="no-visitors">æœ¬æœˆæ²¡æœ‰åŒå­¦ç”Ÿæ—¥</p>';
                    return;
                }
                
                container.innerHTML = thisMonthBirthdays.map(b => `
                    <div class="visitor-card">
                        <h4>ğŸ‚ ${b.name}</h4>
                        <p>ç”Ÿæ—¥: ${b.month}æœˆ${b.day}æ—¥</p>
                    </div>
                `).join('');
            }
        }
        
        // ================================================
        // ã€æ—¥å†ç®¡ç†å™¨ã€‘
        // ================================================
        
        class CalendarManager {
            init() {
                this.generateCalendar();
            }
            
            generateCalendar() {
                const container = document.getElementById('calendarView');
                const today = new Date();
                const currentMonth = today.getMonth();
                const currentYear = today.getFullYear();
                
                // ç”Ÿæˆæ—¥å†çš„ç®€åŒ–ç‰ˆæœ¬
                let calendarHTML = '';
                const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
                
                for (let day = 1; day <= daysInMonth; day++) {
                    const isToday = (day === today.getDate() && currentMonth === today.getMonth());
                    calendarHTML += `
                        <div class="calendar-day ${isToday ? 'today' : ''}">
                            ${day}
                            ${day === 15 ? '<div class="calendar-event">ç­ä¼š</div>' : ''}
                            ${day === 20 ? '<div class="calendar-event">è€ƒè¯•</div>' : ''}
                        </div>
                    `;
                }
                
                container.innerHTML = calendarHTML;
            }
        }
        
        // ================================================
        // ã€ç›¸å†Œç®¡ç†å™¨ã€‘
        // ================================================
        
        class AlbumManager {
            init() {
                this.displayAlbums();
            }
            
            displayAlbums() {
                const container = document.getElementById('albumList');
                
                // ä½¿ç”¨å ä½å›¾ç‰‡
                const albums = [
                    { name: "å¼€å­¦å…¸ç¤¼", count: 12 },
                    { name: "è¿åŠ¨ä¼š", count: 8 },
                    { name: "ç­çº§æ´»åŠ¨", count: 15 },
                    { name: "å­¦ä¹ æ—¶åˆ»", count: 6 }
                ];
                
                container.innerHTML = albums.map(album => `
                    <div class="album-item">
                        <img src="https://via.placeholder.com/200x150/3498db/FFFFFF?text=${encodeURIComponent(album.name)}" alt="${album.name}">
                        <div style="position:absolute;bottom:0;background:rgba(0,0,0,0.7);color:white;width:100%;padding:5px;font-size:0.8rem">
                            ${album.name} (${album.count}å¼ )
                        </div>
                    </div>
                `).join('');
            }
        }
        
        // ================================================
        // ã€æŠ•ç¥¨ç®¡ç†å™¨ã€‘
        // ================================================
        
        class VoteManager {
            init() {
                this.displayVotes();
            }
            
            displayVotes() {
                const container = document.getElementById('voteList');
                
                const votes = [
                    { question: "ç­çº§å‡ºæ¸¸åœ°ç‚¹é€‰æ‹©", options: ["å…¬å›­", "åšç‰©é¦†", "ç§‘æŠ€é¦†", "åŠ¨ç‰©å›­"], votes: [12, 8, 15, 5] },
                    { question: "ç­ä¼šä¸»é¢˜å»ºè®®", options: ["å­¦ä¹ æ–¹æ³•", "æ—¶é—´ç®¡ç†", "å¿ƒç†å¥åº·", "èŒä¸šè§„åˆ’"], votes: [10, 14, 8, 3] }
                ];
                
                container.innerHTML = votes.map((vote, index) => `
                    <h3>${vote.question}</h3>
                    <div class="vote-options">
                        ${vote.options.map((option, i) => {
                            const totalVotes = vote.votes.reduce((a, b) => a + b, 0);
                            const percentage = totalVotes > 0 ? Math.round((vote.votes[i] / totalVotes) * 100) : 0;
                            return `
                                <div class="vote-option">
                                    <span>${option}</span>
                                    <span>${vote.votes[i]}ç¥¨ (${percentage}%)</span>
                                </div>
                                <div class="vote-progress">
                                    <div class="vote-bar" style="width:${percentage}%"></div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    ${index < votes.length - 1 ? '<hr style="margin:20px 0">' : ''}
                `).join('');
            }
        }
        
        // ================================================
        // ã€å…¨å±€å‡½æ•°ã€‘
        // ================================================
        
        function checkLogin() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;
            const errorElement = document.getElementById('loginError');
            
            if (!username || !password) {
                errorElement.textContent = 'è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ';
                return;
            }
            
            if (systemManager.login(username, password)) {
                errorElement.textContent = '';
            } else {
                errorElement.textContent = 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯';
            }
        }
        
        function logout() {
            systemManager.logout();
        }
        
        function addVisitor() {
            const name = document.getElementById('visitorName').value;
            const message = document.getElementById('visitorMessage').value;
            visitorManager.addVisitor(name, message);
        }
        
        function clearAllVisitors() {
            visitorManager.clearAllVisitors();
        }
        
        function copySiteLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                systemManager.showToast('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            });
        }
        
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function showNoticeForm() {
            document.getElementById('noticeForm').style.display = 'block';
        }
        
        function hideNoticeForm() {
            document.getElementById('noticeForm').style.display = 'none';
        }
        
        function addNotice() {
            const title = document.getElementById('noticeTitle').value;
            const content = document.getElementById('noticeContent').value;
            notificationManager.addNotice(title, content);
        }
        
        function switchTab(tabName) {
            // ç§»é™¤æ‰€æœ‰tabçš„activeç±»
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰tab-contentçš„activeç±»
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // æ·»åŠ å½“å‰tabå’Œcontentçš„activeç±»
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        
        // ================================================
        // ã€åˆå§‹åŒ–ã€‘
        // ================================================
        
        const systemManager = new SystemManager();
        const visitorManager = new VisitorManager();
        const notificationManager = new NotificationManager();
        const birthdayManager = new BirthdayManager();
        const calendarManager = new CalendarManager();
        const albumManager = new AlbumManager();
        const voteManager = new VoteManager();
        
        function initScrollButton() {
            window.addEventListener('scroll', function() {
                const btn = document.getElementById('scrollTopBtn');
                btn.style.display = window.scrollY > 300 ? 'block' : 'none';
            });
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ CSSåŠ¨ç”»
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            // å›è½¦é”®ç™»å½•æ”¯æŒ
            document.getElementById('loginUsername').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('loginPassword').focus();
                }
            });
            
            document.getElementById('loginPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') checkLogin();
            });
            
            // åˆå§‹åŒ–å½“å‰å¹´ä»½
            document.getElementById('currentYear').textContent = new Date().getFullYear();
        });
    </script>
</body>
</html>
