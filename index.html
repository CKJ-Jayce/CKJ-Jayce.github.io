<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆè‚¥å®éªŒå­¦æ ¡20çº§2ç­å®˜æ–¹ç½‘ç«™</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Arial','Microsoft YaHei',sans-serif}
        body{line-height:1.6;color:#333;background:#f5f7fa}
        .container{max-width:1200px;margin:0 auto;padding:0 20px}
        .section{padding:60px 0}
        .navbar{background:#fff;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:fixed;width:100%;top:0;z-index:1000}
        .nav-container{max-width:1200px;margin:0 auto;padding:15px 20px;display:flex;justify-content:space-between;align-items:center}
        .logo-container{display:flex;align-items:center;gap:15px}
        .logo{height:40px;width:auto;border-radius:50%}
        .class-name{font-size:1.5rem;font-weight:bold;color:#2c3e50}
        .nav-links{display:flex;gap:30px}
        .nav-links a{text-decoration:none;color:#555;font-weight:500;transition:color .3s}
        .nav-links a:hover{color:#3498db}
        .hero{background:linear-gradient(135deg,#3498db,#2c3e50);color:white;padding:150px 0 100px;text-align:center;margin-top:70px}
        .hero-content h1{font-size:2.8rem;margin-bottom:20px}
        .hero-content p{font-size:1.2rem;margin-bottom:30px;opacity:.9}
        .btn{display:inline-block;background:#e74c3c;color:white;padding:12px 30px;border-radius:30px;text-decoration:none;font-weight:bold;border:none;cursor:pointer;transition:background .3s}
        .btn:hover{background:#c0392b}
        .btn-small{padding:6px 12px;font-size:0.8rem}
        .btn-secondary{background:#3498db}
        .btn-secondary:hover{background:#2980b9}
        .about-content{display:grid;grid-template-columns:2fr 1fr;gap:50px;margin-top:40px}
        @media(max-width:768px){.about-content{grid-template-columns:1fr}}
        .stat{text-align:center;padding:30px;background:white;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
        .stat i{font-size:2.5rem;color:#3498db;margin-bottom:15px}
        .section-subtitle{text-align:center;color:#666;margin-bottom:40px}
        .visitor-form{max-width:500px;margin:0 auto 50px;background:white;padding:30px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
        .visitor-form input,.visitor-form textarea{width:100%;padding:12px;margin-bottom:15px;border:2px solid #ddd;border-radius:5px;font-size:16px}
        .visitor-form input:focus,.visitor-form textarea:focus{border-color:#3498db;outline:none}
        .form-note{font-size:0.9rem;color:#666;margin-top:10px;text-align:center}
        .visitors-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:20px;margin-top:30px}
        @media(max-width:768px){.visitors-list{grid-template-columns:1fr}}
        .visitor-card{background:white;padding:20px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.1);text-align:center;position:relative}
        .visitor-card h4{color:#2c3e50;margin-bottom:10px}
        .visitor-card p{color:#666;font-size:0.9rem}
        .visitor-card .time{font-size:0.8rem;color:#999;margin-top:10px}
        .no-visitors{text-align:center;padding:40px;color:#888;font-style:italic}
        .delete-btn{position:absolute;top:5px;right:5px;background:none;border:none;color:#e74c3c;cursor:pointer;font-size:0.8rem;opacity:0.7}
        .delete-btn:hover{opacity:1}
        footer{background:#2c3e50;color:white;padding:40px 0;text-align:center}
        .footer-content{display:flex;flex-direction:column;align-items:center;gap:20px}
        .footer-logo{display:flex;align-items:center;gap:15px}
        .footer-logo-img{height:30px;width:auto;border-radius:50%}
        .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:30px;margin-top:40px}
        .feature{text-align:center;padding:25px;background:white;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.05)}
        .feature i{font-size:2.5rem;color:#3498db;margin-bottom:15px}
        @media(max-width:768px){.nav-links{display:none}.hero-content h1{font-size:2rem}}
        
        /* ç™»å½•é¡µé¢æ ·å¼ */
        .login-page{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#3498db,#2c3e50);display:flex;justify-content:center;align-items:center;z-index:2000;transition:opacity .5s}
        .login-container{background:white;padding:40px;border-radius:15px;box-shadow:0 15px 35px rgba(0,0,0,0.2);max-width:400px;width:90%;text-align:center}
        .login-form h2{margin-bottom:30px;color:#2c3e50}
        .login-form input{width:100%;padding:12px;margin-bottom:20px;border:2px solid #ddd;border-radius:5px;font-size:16px}
        .login-form input:focus{border-color:#3498db}
        .login-error{color:#e74c3c;margin-bottom:15px;font-size:0.9rem;min-height:20px}
        .login-tabs{display:flex;gap:10px;margin-bottom:30px}
        .login-tab{flex:1;padding:10px;background:#f8f9fa;border-radius:5px;cursor:pointer;transition:all .3s}
        .login-tab.active{background:#3498db;color:white}
        
        /* æ–°å¢æ ·å¼ */
        .user-badge{display:inline-block;padding:2px 8px;border-radius:12px;font-size:0.7rem;font-weight:bold;margin-left:8px}
        .badge-admin{background:#e74c3c;color:white}
        .badge-teacher{background:#3498db;color:white}
        .badge-student{background:#2ecc71;color:white}
        .notifications{max-width:800px;margin:0 auto}
        .notification-card{background:white;padding:20px;margin-bottom:15px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.1);border-left:4px solid #3498db}
        .notification-card.important{border-left-color:#e74c3c}
        .notification-header{display:flex;justify-content:space-between;margin-bottom:10px}
        .notification-title{font-weight:bold;color:#2c3e50}
        .notification-time{font-size:0.8rem;color:#999}
        
        /* èŠ‚å¥ç™»å½•æ ·å¼ */
        .rhythm-btn{width:80px;height:80px;border-radius:50%;background:#3498db;color:white;font-size:1.5rem;display:flex;align-items:center;justify-content:center;cursor:pointer;margin:30px auto;transition:all .1s}
        .rhythm-btn.active{background:#e74c3c;transform:scale(1.1)}
        .rhythm-dots{display:flex;justify-content:center;gap:10px;margin-top:20px}
        .rhythm-dot{width:15px;height:15px;border-radius:50%;background:#ddd}
        .rhythm-dot.active{background:#3498db}
        
        /* æ–°å¢åŠŸèƒ½æ ·å¼ */
        .tabs{display:flex;gap:10px;margin-bottom:30px;flex-wrap:wrap}
        .tab{background:#eee;padding:10px 20px;border-radius:5px;cursor:pointer;transition:all .3s}
        .tab:hover{background:#ddd}
        .tab.active{background:#3498db;color:white}
        .tab-content{display:none}
        .tab-content.active{display:block}
        .homework-list,.calendar,.score-table{background:white;border-radius:10px;padding:25px;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
        .homework-item{padding:15px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}
        .homework-item:last-child{border-bottom:none}
        .calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;margin-top:15px}
        .calendar-day{padding:10px;text-align:center;border-radius:5px;background:#f8f9fa}
        .calendar-day.today{background:#3498db;color:white}
        .score-table table{width:100%;border-collapse:collapse}
        .score-table th,.score-table td{padding:12px;border-bottom:1px solid #eee;text-align:center}
        .score-table th{background:#f8f9fa}
        
        /* æµç•…åº¦ä¼˜åŒ–å’Œä¸‹é›ªæ•ˆæœ */
        html{scroll-behavior:smooth}
        .visitor-card,.stat,.feature,.notification-card{transition:transform .2s,box-shadow .2s}
        .visitor-card:hover,.stat:hover,.feature:hover,.notification-card:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,0,0,0.12)}
        #scrollTopBtn{position:fixed;bottom:30px;right:30px;width:50px;height:50px;border-radius:50%;background:#3498db;color:white;border:none;cursor:pointer;font-size:1.5rem;display:none;z-index:1000;box-shadow:0 3px 10px rgba(0,0,0,0.3);transition:opacity .3s}
        #scrollTopBtn:hover{opacity:.9}
        .fade-in{animation:fadeIn .5s ease-out}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        
        /* ä¸‹é›ªæ•ˆæœ */
        .snowflake {
            position: fixed;
            top: -10px;
            color: #fff;
            font-size: 1em;
            opacity: 0.8;
            pointer-events: none;
            z-index: 9999;
            animation: fall linear infinite;
        }
        @keyframes fall {
            to {transform: translateY(100vh);}
        }
    </style>
</head>
<body>
    <!-- ä¸‹é›ªæ•ˆæœå®¹å™¨ -->
    <div id="snowflakes"></div>
    
    <!-- ç™»å½•é¡µé¢ -->
    <div id="loginPage" class="login-page">
        <div class="login-container">
            <div class="login-tabs">
                <div class="login-tab active" onclick="switchLoginType('password')">å¯†ç ç™»å½•</div>
                <div class="login-tab" onclick="switchLoginType('rhythm')">èŠ‚å¥ç™»å½•ï¼ˆBetaæµ‹è¯•å†…å®¹ï¼‰</div>
            </div>
            
            <!-- å¯†ç ç™»å½• -->
            <div id="passwordLogin" class="login-form">
                <h2><i class="fas fa-user-graduate"></i> ç™»å½•ï¼Œè®¿é—®ç¾å¥½ä¸–ç•Œï¼</h2>
                <input type="text" id="loginUsername" placeholder="ç”¨æˆ·å" autocomplete="off">
                <input type="password" id="loginPassword" placeholder="å¯†ç " autocomplete="off">
                <div id="loginError" class="login-error"></div>
                <button onclick="checkLogin()" class="btn">ç™»å½•</button>
                <div class="login-info" style="margin-top:20px;">
                    <p><i class="fas fa-info-circle"></i> è¯·è”ç³»ç®¡ç†å‘˜è·å–è´¦å·</p>
                </div>
            </div>
            
            <!-- èŠ‚å¥ç™»å½• -->
            <div id="rhythmLogin" class="login-form" style="display:none;">
                <h2><i class="fas fa-music"></i> èŠ‚å¥ç™»å½•ï¼ˆBetaï¼‰</h2>
                <p style="color:#666; margin-bottom:20px;">æŒ‰ç…§æç¤ºèŠ‚å¥ç‚¹å‡»æŒ‰é’®</p>
                
                <div id="rhythmButton" class="rhythm-btn">
                    ğŸ‘†æˆ³å®ƒï¼
                </div>
                
                <div id="rhythmDots" class="rhythm-dots">
                    <div class="rhythm-dot"></div>
                    <div class="rhythm-dot"></div>
                    <div class="rhythm-dot"></div>
                    <div class="rhythm-dot"></div>
                </div>
                
                <div id="rhythmHint" style="margin-top:10px; color:#666; font-size:0.9rem;">
                    èŠ‚å¥ï¼šå¿«-å¿«-æ…¢-å¿«
                </div>
                
                <div id="rhythmError" class="login-error"></div>
                <button onclick="checkRhythmLogin()" class="btn">éªŒè¯èŠ‚å¥</button>
                <div class="login-info" style="margin-top:20px;">
                    <p><i class="fas fa-info-circle"></i> æç¤ºï¼š300ms, 300ms, 600ms, 300ms</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸»ç½‘ç«™å†…å®¹ -->
    <div id="mainContent" style="display:none;">
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo-container">
                    <img src="class-badge.png" alt="ç­å¾½" class="logo" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0NSIgZmlsbD0iIzM0OThkYiIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5YiG5LqrPC90ZXh0Pjwvc3ZnPg=='">
                    <span class="class-name">åˆè‚¥å®éªŒå­¦æ ¡20çº§2ç­å®˜æ–¹ç½‘ç«™</span>
                    <span style="font-size:0.9rem;color:#666;margin-left:10px;">
                        ç™»å½•è´¦å·ä¸º: <span id="loggedInUser">ç­çº§æˆå‘˜</span>
                        <span id="userBadge" class="user-badge"></span>
                    </span>
                </div>
                <div class="nav-links">
                    <a href="#home">é¦–é¡µ</a>
                    <a href="#about">å…³äºæˆ‘ä»¬</a>
                    <a href="#notices">ç­çº§é€šçŸ¥</a>
                    <a href="#features">ç­çº§ç‰¹è‰²</a>
                    <a href="#contact">ç•™è¨€æ¿</a>
                    <a href="#functions">æ›´å¤šåŠŸèƒ½</a>
                    <a href="#" onclick="logout()" style="color:#e74c3c"><i class="fas fa-sign-out-alt"></i> é€€å‡º</a>
                </div>
            </div>
        </nav>

        <section id="home" class="hero fade-in">
            <div class="hero-content">
                <h1>æ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„ç­çº§</h1>
                <p>å›¢ç»“ã€å¥‹è¿›ã€æ±‚çŸ¥ã€æˆé•¿</p>
                <a href="#about" class="btn">äº†è§£æ›´å¤š</a>
            </div>
        </section>

        <section id="about" class="section">
            <div class="container">
                <h2>å…³äºæˆ‘ä»¬</h2>
                <div class="about-content">
                    <div class="about-text">
                        <h3>ç­çº§ç®€ä»‹</h3>
                        <p>æˆ‘ä»¬æ˜¯ä¸€ä¸ªå……æ»¡æ´»åŠ›ã€ç§¯æå‘ä¸Šçš„é›†ä½“ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸€èµ·å­¦ä¹ ï¼Œä¸€èµ·æˆé•¿ï¼Œå…±åŒåˆ›é€ ç¾å¥½çš„å›å¿†ã€‚</p>
                        <h3>ç­çº§å®£è¨€</h3>
                        <p>ä»¥æ¢¦ä¸ºé©¬ï¼Œä¸è´ŸéŸ¶åï¼›ä»¥å‹¤ä¸ºå¾„ï¼Œå‹‡æ”€é«˜å³°ã€‚</p>
                    </div>
                    <div class="about-stats">
                        <div class="stat fade-in" style="animation-delay:0.1s">
                            <i class="fas fa-users"></i>
                            <h3>ç­çº§äººæ•°</h3>
                            <p>43äºº</p>
                        </div>
                        <div class="stat fade-in" style="animation-delay:0.2s">
                            <i class="fas fa-graduation-cap"></i>
                            <h3>æˆç«‹æ—¶é—´</h3>
                            <p>2020å¹´9æœˆ</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç­çº§é€šçŸ¥ -->
        <section id="notices" class="section bg-light">
            <div class="container">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:30px">
                    <h2>ç­çº§é€šçŸ¥</h2>
                    <button id="addNoticeBtn" class="btn btn-small" onclick="showNoticeForm()" style="display:none">
                        <i class="fas fa-plus"></i> å‘å¸ƒé€šçŸ¥
                    </button>
                </div>
                
                <div id="noticeForm" class="visitor-form" style="display:none">
                    <input type="text" id="noticeTitle" placeholder="é€šçŸ¥æ ‡é¢˜" maxlength="50">
                    <textarea id="noticeContent" placeholder="é€šçŸ¥å†…å®¹" rows="4" maxlength="200"></textarea>
                    <div style="display:flex;gap:10px">
                        <button onclick="addNotice()" class="btn">å‘å¸ƒé€šçŸ¥</button>
                        <button onclick="hideNoticeForm()" class="btn btn-secondary">å–æ¶ˆ</button>
                    </div>
                </div>
                
                <div id="notificationsList" class="notifications">
                    <!-- é€šçŸ¥å†…å®¹åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </section>

        <!-- ç­çº§ç‰¹è‰² -->
        <section id="features" class="section">
            <div class="container">
                <h2>ç­çº§ç‰¹è‰²</h2>
                <div class="features">
                    <div class="feature fade-in" style="animation-delay:0.1s">
                        <i class="fas fa-heart"></i>
                        <h3>å›¢ç»“å‹çˆ±</h3>
                        <p>æˆ‘ä»¬åƒä¸€ä¸ªå¤§å®¶åº­ï¼Œäº’å¸®äº’åŠ©ï¼Œå…±åŒè¿›æ­¥ã€‚</p>
                    </div>
                    <div class="feature fade-in" style="animation-delay:0.2s">
                        <i class="fas fa-lightbulb"></i>
                        <h3>åˆ›æ–°æ€ç»´</h3>
                        <p>é¼“åŠ±åˆ›æ–°ï¼ŒåŸ¹å…»è§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚</p>
                    </div>
                    <div class="feature fade-in" style="animation-delay:0.3s">
                        <i class="fas fa-book"></i>
                        <h3>çƒ­çˆ±å­¦ä¹ </h3>
                        <p>è¥é€ æµ“åšçš„å­¦ä¹ æ°›å›´ï¼Œè¿½æ±‚å“è¶Šã€‚</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç•™è¨€æ¿ -->
        <section id="contact" class="section bg-light">
            <div class="container">
                <h2>ç•™è¨€æ¿</h2>
                <p class="section-subtitle">ç•™ä¸‹ä½ çš„åå­—ï¼Œè®©æˆ‘ä»¬çŸ¥é“ä½ æ¥è¿‡ï¼</p>
                
                <div class="visitor-form fade-in">
                    <input type="text" id="visitorName" placeholder="è¯·è¾“å…¥ä½ çš„åå­—" maxlength="20">
                    <input type="text" id="visitorMessage" placeholder="æƒ³è¯´ç‚¹ä»€ä¹ˆï¼Ÿï¼ˆå¯é€‰ï¼‰" maxlength="50">
                    <button onclick="addVisitor()" class="btn">ç•™ä¸‹æˆ‘çš„åå­—</button>
                    <p class="form-note">æ³¨æ„ï¼šç•™è¨€ä»…ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œåˆ·æ–°é¡µé¢ä¼šæ¸…ç©º</p>
                    <div style="display:flex;gap:10px;justify-content:center;margin-top:15px">
                        <button onclick="clearAllVisitors()" class="btn btn-small">æ¸…ç©ºç•™è¨€</button>
                        <button onclick="copySiteLink()" class="btn btn-small">å¤åˆ¶é“¾æ¥</button>
                    </div>
                </div>

                <div class="visitors-container">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                        <h3>æœ€è¿‘è®¿å®¢</h3>
                        <div style="color:#666;font-size:0.9rem">
                            å…± <span id="totalMessages">0</span> æ¡ç•™è¨€
                        </div>
                    </div>
                    <div id="visitorsList" class="visitors-list"></div>
                </div>
            </div>
        </section>

        <!-- æ›´å¤šåŠŸèƒ½ -->
        <section id="functions" class="section">
            <div class="container">
                <h2>æ›´å¤šåŠŸèƒ½</h2>
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('homework')">ä½œä¸šç®¡ç†</div>
                    <div class="tab" onclick="switchTab('calendar')">ç­çº§æ—¥å†</div>
                    <div class="tab" onclick="switchTab('score')">æˆç»©æŸ¥è¯¢</div>
                </div>
                
                <div id="homework" class="tab-content active">
                    <div class="homework-list">
                        <h3>è¿‘æœŸä½œä¸š</h3>
                        <div id="homeworkItems">
                            <!-- ä½œä¸šåˆ—è¡¨åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <div id="calendar" class="tab-content">
                    <div class="calendar">
                        <h3>ç­çº§æ—¥å†</h3>
                        <div id="calendarView" class="calendar-grid"></div>
                    </div>
                </div>
                
                <div id="score" class="tab-content">
                    <div class="score-table">
                        <h3>æˆç»©æŸ¥è¯¢</h3>
                        <div id="scoreList">
                            <!-- æˆç»©åˆ—è¡¨åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer>
            <div class="container">
                <div class="footer-content">
                    <div class="footer-logo">
                        <img src="class-badge.png" alt="ç­å¾½" class="footer-logo-img" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0NSIgZmlsbD0iIzM0OThkYiIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+5YiG5LqrPC90ZXh0Pjwvc3ZnPg=='">
                        <p>20ï¼ˆ2ï¼‰ç­çš„å®˜æ–¹ç½‘ç«™</p>
                    </div>
                    <p>&copy; <span id="currentYear">2026</span> æ­¤ç­æœ€ç‰›ç¨‹åºçŒ¿ä¸€æš. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
                </div>
            </div>
        </footer>

        <!-- æ»šåŠ¨åˆ°é¡¶éƒ¨æŒ‰é’® -->
        <button id="scrollTopBtn" onclick="scrollToTop()">â†‘</button>
    </div>

    <script>
        // ================================================
        // ã€ç³»ç»Ÿæ ¸å¿ƒé…ç½®ã€‘
        // ================================================
        
        // é¢„è®¾è´¦å·é…ç½®
        const PRESET_ACCOUNTS = [
            { username: "ç®¡ç†å‘˜", password: "SYYADMIN", displayName: "ç®¡ç†å‘˜å­™äº¦é˜³", level: 3 },
            { username: "å§šç¬‘ç¬‘", password: "teacherY", displayName: "ç­ä¸»ä»»", level: 2 },
            { username: "é’±æ€å®‡", password: "QSY", displayName: "é’±æ€å®‡ã€ç­çº§äººä¸Šäººï¼Œæ¯”äººé«˜ä¸€ç­‰ã€‘", level: 1 },
            { username: "éƒ‘æ¢“çº", password: "113514", displayName: "èœé—®", level: 1 },
            { username: "ææ¬£æ³½", password: "114514", displayName: "å…­å…­å…­", level: 1 }
        ];
        
        // ç­‰çº§æƒé™æ˜ å°„
        const LEVEL_PERMISSIONS = {
            3: { name: "ç®¡ç†å‘˜", badge: "badge-admin", color: "#e74c3c", canManage: true },
            2: { name: "æ•™å¸ˆ", badge: "badge-teacher", color: "#3498db", canManage: true },
            1: { name: "å­¦ç”Ÿ", badge: "badge-student", color: "#2ecc71", canManage: false }
        };
        
        // èŠ‚å¥ç™»å½•é…ç½®
        const RHYTHM_PATTERN = [300, 600, 600, 300]; // å¿«-æ…¢-æ…¢-å¿« (æ¯«ç§’)
        
        // ================================================
        // ã€æ ¸å¿ƒç³»ç»Ÿç±»ã€‘
        // ================================================
        
        class SystemManager {
            constructor() {
                this.loginKey = 'class_login_status';
                this.userKey = 'class_logged_in_user';
                this.levelKey = 'user_level';
                this.checkAutoLogin();
            }
            
            checkAutoLogin() {
                const isLoggedIn = localStorage.getItem(this.loginKey);
                const loggedInUser = localStorage.getItem(this.userKey);
                const userLevel = localStorage.getItem(this.levelKey);
                
                if (isLoggedIn === 'true' && loggedInUser && userLevel) {
                    this.showMainContent(loggedInUser, parseInt(userLevel));
                }
            }
            
            login(username, password) {
                const account = PRESET_ACCOUNTS.find(acc => 
                    acc.username === username && acc.password === password
                );
                
                if (account) {
                    localStorage.setItem(this.loginKey, 'true');
                    localStorage.setItem(this.userKey, account.displayName);
                    localStorage.setItem(this.levelKey, account.level.toString());
                    this.showMainContent(account.displayName, account.level);
                    return true;
                }
                return false;
            }
            
            logout() {
                if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                    localStorage.removeItem(this.loginKey);
                    localStorage.removeItem(this.userKey);
                    localStorage.removeItem(this.levelKey);
                    this.showLoginPage();
                }
            }
            
            showMainContent(displayName, level) {
                document.getElementById('loginPage').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('mainContent').style.display = 'block';
                    
                    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
                    document.getElementById('loggedInUser').textContent = displayName;
                    
                    // æ˜¾ç¤ºç­‰çº§å¾½ç« 
                    const badgeElement = document.getElementById('userBadge');
                    const permission = LEVEL_PERMISSIONS[level];
                    if (permission) {
                        badgeElement.className = `user-badge ${permission.badge}`;
                        badgeElement.textContent = permission.name;
                        badgeElement.style.backgroundColor = permission.color;
                    }
                    
                    // æ ¹æ®æƒé™æ˜¾ç¤ºç®¡ç†æŒ‰é’®
                    if (permission.canManage) {
                        document.getElementById('addNoticeBtn').style.display = 'block';
                    }
                    
                    // æ˜¾ç¤ºé€šçŸ¥
                    this.showToast(`æ¬¢è¿å›æ¥ï¼Œ${displayName}ï¼`, 'success');
                    
                    // åˆå§‹åŒ–å„æ¨¡å—
                    visitorManager.init();
                    notificationManager.init();
                    homeworkManager.init();
                    calendarManager.init();
                    scoreManager.init();
                    
                    // åˆå§‹åŒ–æ»šåŠ¨æŒ‰é’®
                    initScrollButton();
                    document.getElementById('currentYear').textContent = new Date().getFullYear();
                }, 500);
            }
            
            showLoginPage() {
                document.getElementById('loginPage').style.display = 'flex';
                setTimeout(() => {
                    document.getElementById('loginPage').style.opacity = '1';
                    document.getElementById('mainContent').style.display = 'none';
                    document.getElementById('loginUsername').value = '';
                    document.getElementById('loginPassword').value = '';
                    document.getElementById('loginError').textContent = '';
                    resetRhythmLogin();
                }, 100);
            }
            
            showToast(message, type = 'info') {
                const toast = document.createElement('div');
                const colors = { success: '#2ecc71', warning: '#f39c12', info: '#3498db', error: '#e74c3c' };
                toast.innerHTML = `
                    <div style="
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: ${colors[type] || '#3498db'};
                        color: white;
                        padding: 15px 25px;
                        border-radius: 5px;
                        animation: slideIn 0.3s ease-out;
                        z-index: 1001;
                        box-shadow: 0 3px 10px rgba(0,0,0,0.2);
                    ">
                        <i class="fas fa-${type === 'success' ? 'check' : 'info'}-circle"></i> ${message}
                    </div>
                `;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.animation = 'slideOut 0.3s ease-out forwards';
                    setTimeout(() => toast.remove(), 300);
                }, 2000);
            }
            
            getCurrentLevel() {
                return parseInt(localStorage.getItem(this.levelKey) || '0');
            }
        }
        
        // ================================================
        // ã€èŠ‚å¥ç™»å½•ç±»ã€‘
        // ================================================
        
        class RhythmLogin {
            constructor() {
                this.clickTimes = [];
                this.lastClickTime = 0;
                this.currentStep = 0;
                this.isActive = false;
                this.init();
            }
            
            init() {
                const rhythmBtn = document.getElementById('rhythmButton');
                rhythmBtn.addEventListener('mousedown', () => this.recordClick());
                rhythmBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    this.recordClick();
                });
            }
            
            recordClick() {
                const now = Date.now();
                const rhythmBtn = document.getElementById('rhythmButton');
                
                // æŒ‰é’®è§†è§‰åé¦ˆ
                rhythmBtn.classList.add('active');
                setTimeout(() => rhythmBtn.classList.remove('active'), 100);
                
                if (this.lastClickTime > 0) {
                    const interval = now - this.lastClickTime;
                    this.clickTimes.push(interval);
                    
                    // æ›´æ–°è¿›åº¦ç‚¹
                    const dots = document.querySelectorAll('.rhythm-dot');
                    if (this.currentStep < dots.length) {
                        dots[this.currentStep].classList.add('active');
                        this.currentStep++;
                    }
                }
                
                this.lastClickTime = now;
                
                // æ’­æ”¾ç‚¹å‡»éŸ³æ•ˆ
                this.playClickSound();
            }
            
            checkRhythm() {
                if (this.clickTimes.length !== RHYTHM_PATTERN.length) {
                    return false;
                }
                
                // å…è®¸20%çš„è¯¯å·®èŒƒå›´
                for (let i = 0; i < this.clickTimes.length; i++) {
                    const diff = Math.abs(this.clickTimes[i] - RHYTHM_PATTERN[i]);
                    const error = diff / RHYTHM_PATTERN[i];
                    
                    if (error > 0.2) return false;
                }
                
                return true;
            }
            
            reset() {
                this.clickTimes = [];
                this.lastClickTime = 0;
                this.currentStep = 0;
                
                // é‡ç½®è¿›åº¦ç‚¹
                document.querySelectorAll('.rhythm-dot').forEach(dot => {
                    dot.classList.remove('active');
                });
            }
            
            playClickSound() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 800 + (this.currentStep * 100);
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                } catch (e) {
                    // éŸ³é¢‘ä¸Šä¸‹æ–‡å¯èƒ½ä¸è¢«æ”¯æŒï¼Œå¿½ç•¥é”™è¯¯
                }
            }
        }
        
        // ================================================
        // ã€ç•™è¨€ç®¡ç†å™¨ã€‘
        // ================================================
        
        class VisitorManager {
            constructor() {
                this.visitorsKey = 'class_visitors';
                this.maxVisitors = 20;
            }
            
            init() {
                this.displayVisitors();
                if (!this.getVisitors().length) {
                    this.addSampleVisitors();
                }
                this.updateStats();
            }
            
            addSampleVisitors() {
                const samples = [
                    { name: "ç­ä¸»ä»»", message: "åŒå­¦ä»¬åŠ æ²¹ï¼" },
                    { name: "å°å­™", message: "ç­çº§ç½‘ç«™å¤ªæ£’äº†ï¼" },
                    { name: "å°å¼ ", message: "ä¸ºæˆ‘ä»¬çš„ç­çº§è‡ªè±ª" }
                ];
                samples.forEach(v => this.addVisitor(v.name, v.message, true));
            }
            
            addVisitor(name, message = '', isSample = false) {
                if (!isSample && !name.trim()) {
                    systemManager.showToast('è¯·è¾“å…¥ä½ çš„åå­—', 'warning');
                    return;
                }
                
                const visitor = {
                    name: name.trim().substr(0, 20),
                    message: message.trim().substr(0, 50),
                    time: new Date().toLocaleString('zh-CN'),
                    id: Date.now() + Math.random().toString(36).substr(2, 9)
                };
                
                let visitors = this.getVisitors();
                visitors.unshift(visitor);
                
                if (visitors.length > this.maxVisitors) {
                    visitors = visitors.slice(0, this.maxVisitors);
                }
                
                localStorage.setItem(this.visitorsKey, JSON.stringify(visitors));
                this.displayVisitors();
                
                if (!isSample) {
                    document.getElementById('visitorName').value = '';
                    document.getElementById('visitorMessage').value = '';
                    systemManager.showToast('ç•™è¨€æˆåŠŸï¼', 'success');
                }
            }
            
            deleteVisitor(id) {
                if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡ç•™è¨€å—ï¼Ÿ')) return;
                
                let visitors = this.getVisitors();
                visitors = visitors.filter(v => v.id !== id);
                localStorage.setItem(this.visitorsKey, JSON.stringify(visitors));
                this.displayVisitors();
                systemManager.showToast('å·²åˆ é™¤ç•™è¨€', 'info');
            }
            
            clearAllVisitors() {
                if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ç•™è¨€å—ï¼Ÿ')) {
                    localStorage.removeItem(this.visitorsKey);
                    this.displayVisitors();
                    systemManager.showToast('å·²æ¸…ç©ºç•™è¨€', 'info');
                }
            }
            
            getVisitors() {
                const visitors = localStorage.getItem(this.visitorsKey);
                return visitors ? JSON.parse(visitors) : [];
            }
            
            displayVisitors() {
                const visitors = this.getVisitors();
                const container = document.getElementById('visitorsList');
                
                if (!visitors.length) {
                    container.innerHTML = '<p class="no-visitors">è¿˜æ²¡æœ‰è®¿å®¢ï¼Œå¿«æ¥æˆä¸ºç¬¬ä¸€ä¸ªå§ï¼</p>';
                    this.updateStats();
                    return;
                }
                
                container.innerHTML = visitors.map(v => `
                    <div class="visitor-card fade-in">
                        ${systemManager.getCurrentLevel() >= 2 ? 
                            `<button class="delete-btn" onclick="visitorManager.deleteVisitor('${v.id}')" title="åˆ é™¤">
                                <i class="fas fa-times"></i>
                            </button>` : ''}
                        <h4>${this.escapeHtml(v.name)}</h4>
                        ${v.message ? `<p>${this.escapeHtml(v.message)}</p>` : ''}
                        <div class="time">${v.time}</div>
                    </div>
                `).join('');
                this.updateStats();
            }
            
            updateStats() {
                document.getElementById('totalMessages').textContent = this.getVisitors().length;
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }
        
        // ================================================
        // ã€é€šçŸ¥ç®¡ç†å™¨ã€‘
        // ================================================
        
        class NotificationManager {
            constructor() {
                this.noticesKey = 'class_notices';
            }
            
            init() {
                this.displayNotices();
                if (!this.getNotices().length) {
                    this.addSampleNotices();
                }
            }
            
            addSampleNotices() {
                const samples = [
                    { title: "é‡è¦é€šçŸ¥", content: "ä»Šå¤©å¥½åƒå‘è¯­æ–‡è¯•å·", time: "2026-01-07", important: true },
                    { title: "ç­çº§æ´»åŠ¨", content: "ä¸‹å­¦æœŸè¦ä¸¾è¡Œè¶³çƒâš½ï¸æ¯”èµ›ï¼", time: "2026-01-07", important: false }
                ];
                samples.forEach(notice => this.addNotice(notice.title, notice.content, true, notice.important));
            }
            
            addNotice(title, content, isSample = false, important = false) {
                if (!isSample && (!title.trim() || !content.trim())) {
                    systemManager.showToast('è¯·å¡«å†™å®Œæ•´é€šçŸ¥ä¿¡æ¯', 'warning');
                    return;
                }
                
                // æ£€æŸ¥æƒé™ï¼šåªæœ‰ç®¡ç†å‘˜å’Œæ•™å¸ˆå¯ä»¥å‘å¸ƒé€šçŸ¥
                if (!isSample && systemManager.getCurrentLevel() < 2) {
                    systemManager.showToast('æ‚¨æ²¡æœ‰æƒé™å‘å¸ƒé€šçŸ¥', 'error');
                    return;
                }
                
                const notice = {
                    title: title.trim(),
                    content: content.trim(),
                    time: new Date().toLocaleDateString('zh-CN'),
                    id: Date.now(),
                    important: important
                };
                
                let notices = this.getNotices();
                notices.unshift(notice);
                localStorage.setItem(this.noticesKey, JSON.stringify(notices));
                this.displayNotices();
                
                if (!isSample) {
                    document.getElementById('noticeTitle').value = '';
                    document.getElementById('noticeContent').value = '';
                    hideNoticeForm();
                    systemManager.showToast('é€šçŸ¥å‘å¸ƒæˆåŠŸï¼', 'success');
                }
            }
            
            deleteNotice(id) {
                if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡é€šçŸ¥å—ï¼Ÿ')) return;
                
                let notices = this.getNotices();
                notices = notices.filter(n => n.id !== id);
                localStorage.setItem(this.noticesKey, JSON.stringify(notices));
                this.displayNotices();
                systemManager.showToast('å·²åˆ é™¤é€šçŸ¥', 'info');
            }
            
            getNotices() {
                const notices = localStorage.getItem(this.noticesKey);
                return notices ? JSON.parse(notices) : [];
            }
            
            displayNotices() {
                const notices = this.getNotices();
                const container = document.getElementById('notificationsList');
                
                if (!notices.length) {
                    container.innerHTML = '<p class="no-visitors">æš‚æ— é€šçŸ¥</p>';
                    return;
                }
                
                container.innerHTML = notices.map(n => `
                    <div class="notification-card ${n.important ? 'important' : ''}">
                        <div class="notification-header">
                            <div class="notification-title">${this.escapeHtml(n.title)}</div>
                            <div class="notification-time">${n.time}</div>
                        </div>
                        <p>${this.escapeHtml(n.content)}</p>
                        ${systemManager.getCurrentLevel() >= 2 ? 
                            `<button class="delete-btn" onclick="notificationManager.deleteNotice(${n.id})" title="åˆ é™¤é€šçŸ¥">
                                <i class="fas fa-trash"></i>
                            </button>` : ''}
                    </div>
                `).join('');
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }
        
        // ================================================
        // ã€ä½œä¸šç®¡ç†å™¨ã€‘
        // ================================================
        
        class HomeworkManager {
            constructor() {
                this.homeworkKey = 'class_homework';
            }
            
            init() {
                this.displayHomework();
                if (!this.getHomework().length) {
                    this.addSampleHomework();
                }
            }
            
            addSampleHomework() {
                const samples = [
                    { subject: "æ•°å­¦", content: "åŸºç¡€è®­ç»ƒ1é¢", deadline: "2026-01-07", completed: false },
                    { subject: "è¯­æ–‡", content: "ä¸çŸ¥é“ğŸ˜–", deadline: "2026-01-07", completed: false },
                    { subject: "è‹±è¯­", content: "ä¸æƒ³å†™ğŸ˜–", deadline: "2026-01-07", completed: true }
                ];
                samples.forEach(hw => this.addHomework(hw.subject, hw.content, hw.deadline, hw.completed, true));
            }
            
            addHomework(subject, content, deadline, completed = false, isSample = false) {
                const homework = {
                    subject: subject.trim(),
                    content: content.trim(),
                    deadline: deadline,
                    completed: completed,
                    id: Date.now() + Math.random().toString(36).substr(2, 9)
                };
                
                let homeworkList = this.getHomework();
                homeworkList.unshift(homework);
                localStorage.setItem(this.homeworkKey, JSON.stringify(homeworkList));
                this.displayHomework();
                
                if (!isSample) {
                    systemManager.showToast('ä½œä¸šæ·»åŠ æˆåŠŸï¼', 'success');
                }
            }
            
            toggleComplete(id) {
                let homeworkList = this.getHomework();
                homeworkList = homeworkList.map(hw => {
                    if (hw.id === id) {
                        hw.completed = !hw.completed;
                    }
                    return hw;
                });
                localStorage.setItem(this.homeworkKey, JSON.stringify(homeworkList));
                this.displayHomework();
            }
            
            deleteHomework(id) {
                if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™é¡¹ä½œä¸šå—ï¼Ÿ')) return;
                
                let homeworkList = this.getHomework();
                homeworkList = homeworkList.filter(hw => hw.id !== id);
                localStorage.setItem(this.homeworkKey, JSON.stringify(homeworkList));
                this.displayHomework();
                systemManager.showToast('å·²åˆ é™¤ä½œä¸š', 'info');
            }
            
            getHomework() {
                const homework = localStorage.getItem(this.homeworkKey);
                return homework ? JSON.parse(homework) : [];
            }
            
            displayHomework() {
                const homeworkList = this.getHomework();
                const container = document.getElementById('homeworkItems');
                
                if (!homeworkList.length) {
                    container.innerHTML = '<p class="no-visitors">æš‚æ— ä½œä¸š</p>';
                    return;
                }
                
                container.innerHTML = homeworkList.map(hw => `
                    <div class="homework-item">
                        <div>
                            <strong>${this.escapeHtml(hw.subject)}</strong>
                            <p style="margin:5px 0;color:#666">${this.escapeHtml(hw.content)}</p>
                            <small style="color:#999">æˆªæ­¢: ${hw.deadline}</small>
                        </div>
                        <div>
                            <button onclick="homeworkManager.toggleComplete('${hw.id}')" style="
                                background:${hw.completed ? '#2ecc71' : '#95a5a6'};
                                color:white;border:none;padding:5px 10px;border-radius:3px;cursor:pointer">
                                ${hw.completed ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ'}
                            </button>
                            ${systemManager.getCurrentLevel() >= 2 ? 
                                `<button onclick="homeworkManager.deleteHomework('${hw.id}')" style="
                                    background:#e74c3c;color:white;border:none;padding:5px 10px;
                                    border-radius:3px;cursor:pointer;margin-left:5px">
                                    åˆ é™¤
                                </button>` : ''}
                        </div>
                    </div>
                `).join('');
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }
        
        // ================================================
        // ã€æ—¥å†ç®¡ç†å™¨ã€‘
        // ================================================
        
        class CalendarManager {
            init() {
                this.generateCalendar();
            }
            
            generateCalendar() {
                const container = document.getElementById('calendarView');
                const today = new Date();
                const currentMonth = today.getMonth();
                const currentYear = today.getFullYear();
                
                // è·å–å½“æœˆå¤©æ•°
                const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
                
                // ç”Ÿæˆæ—¥å†
                let calendarHTML = '';
                
                // æ·»åŠ æ˜ŸæœŸæ ‡é¢˜
                const weekdays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
                weekdays.forEach(day => {
                    calendarHTML += `<div style="padding:10px;text-align:center;font-weight:bold">${day}</div>`;
                });
                
                // æ·»åŠ æ—¥æœŸ
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(currentYear, currentMonth, day);
                    const isToday = (day === today.getDate() && currentMonth === today.getMonth());
                    const isEvent = this.hasEvent(day, currentMonth);
                    
                    calendarHTML += `
                        <div class="calendar-day ${isToday ? 'today' : ''}" style="position:relative">
                            ${day}
                            ${isEvent ? '<div style="position:absolute;bottom:2px;left:50%;transform:translateX(-50%);width:6px;height:6px;background:#e74c3c;border-radius:50%"></div>' : ''}
                        </div>
                    `;
                }
                
                container.innerHTML = calendarHTML;
            }
            
            hasEvent(day, month) {
                // æ¨¡æ‹Ÿäº‹ä»¶æ£€æµ‹
                const events = {
                    15: "",
                    20: "",
                    25: ""
                };
                return events[day];
            }
        }
        
        // ================================================
        // ã€æˆç»©ç®¡ç†å™¨ã€‘
        // ================================================
        
        class ScoreManager {
            constructor() {
                this.scoresKey = 'class_scores';
            }
            
            init() {
                this.displayScores();
                if (!this.getScores().length) {
                    this.addSampleScores();
                }
            }
            
            addSampleScores() {
                const samples = [
                    { subject: "æš‚æœªå¼€æ”¾", score: 92, date: "2026-01-01", rank: 5 },
                    { subject: "æš‚æœªå¼€æ”¾", score: 85, date: "2026-01-01", rank: 12 }
                ];
                samples.forEach(score => this.addScore(score.subject, score.score, score.date, score.rank, true));
            }
            
            addScore(subject, score, date, rank, isSample = false) {
                const scoreData = {
                    subject: subject.trim(),
                    score: score,
                    date: date,
                    rank: rank,
                    id: Date.now() + Math.random().toString(36).substr(2, 9)
                };
                
                let scores = this.getScores();
                scores.unshift(scoreData);
                localStorage.setItem(this.scoresKey, JSON.stringify(scores));
                this.displayScores();
                
                if (!isSample) {
                    systemManager.showToast('æˆç»©æ·»åŠ æˆåŠŸï¼', 'success');
                }
            }
            
            getScores() {
                const scores = localStorage.getItem(this.scoresKey);
                return scores ? JSON.parse(scores) : [];
            }
            
            displayScores() {
                const scores = this.getScores();
                const container = document.getElementById('scoreList');
                
                if (!scores.length) {
                    container.innerHTML = '<p class="no-visitors">æš‚æ— æˆç»©æ•°æ®</p>';
                    return;
                }
                
                let tableHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>ç§‘ç›®</th>
                                <th>åˆ†æ•°</th>
                                <th>æ—¥æœŸ</th>
                                <th>ç­çº§æ’å</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                scores.forEach(score => {
                    const scoreColor = score.score >= 90 ? '#2ecc71' : 
                                      score.score >= 80 ? '#f39c12' : '#e74c3c';
                    
                    tableHTML += `
                        <tr>
                            <td>${this.escapeHtml(score.subject)}</td>
                            <td style="color:${scoreColor};font-weight:bold">${score.score}</td>
                            <td>${score.date}</td>
                            <td>ç¬¬${score.rank}å</td>
                        </tr>
                    `;
                });
                
                tableHTML += '</tbody></table>';
                container.innerHTML = tableHTML;
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }
        
        // ================================================
        // ã€å…¨å±€å‡½æ•°ã€‘
        // ================================================
        
        // åˆå§‹åŒ–ç®¡ç†å™¨
        const systemManager = new SystemManager();
        const rhythmLogin = new RhythmLogin();
        const visitorManager = new VisitorManager();
        const notificationManager = new NotificationManager();
        const homeworkManager = new HomeworkManager();
        const calendarManager = new CalendarManager();
        const scoreManager = new ScoreManager();
        
        // åˆ‡æ¢ç™»å½•ç±»å‹
        function switchLoginType(type) {
            document.querySelectorAll('.login-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.getElementById('passwordLogin').style.display = type === 'password' ? 'block' : 'none';
            document.getElementById('rhythmLogin').style.display = type === 'rhythm' ? 'block' : 'none';
            
            if (type === 'rhythm') {
                resetRhythmLogin();
            }
        }
        
        // é‡ç½®èŠ‚å¥ç™»å½•
        function resetRhythmLogin() {
            rhythmLogin.reset();
            document.getElementById('rhythmError').textContent = '';
        }
        
        // å¯†ç ç™»å½•
        function checkLogin() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;
            const errorElement = document.getElementById('loginError');
            
            if (!username || !password) {
                errorElement.textContent = 'è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ';
                return;
            }
            
            if (systemManager.login(username, password)) {
                errorElement.textContent = '';
            } else {
                errorElement.textContent = 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯';
            }
        }
        
        // èŠ‚å¥ç™»å½•
        function checkRhythmLogin() {
            if (rhythmLogin.checkRhythm()) {
                // èŠ‚å¥æ­£ç¡®ï¼Œä½¿ç”¨é¢„è®¾çš„èŠ‚å¥ç™»å½•è´¦å·
                const rhythmAccount = PRESET_ACCOUNTS.find(acc => acc.username === "student01");
                if (rhythmAccount) {
                    localStorage.setItem('class_login_status', 'true');
                    localStorage.setItem('class_logged_in_user', rhythmAccount.displayName);
                    localStorage.setItem('user_level', rhythmAccount.level.toString());
                    systemManager.showMainContent(rhythmAccount.displayName, rhythmAccount.level);
                    document.getElementById('rhythmError').textContent = '';
                }
            } else {
                document.getElementById('rhythmError').textContent = 'èŠ‚å¥ä¸æ­£ç¡®ï¼Œè¯·é‡è¯•';
                resetRhythmLogin();
            }
        }
        
        // é€€å‡ºç™»å½•
        function logout() {
            systemManager.logout();
        }
        
        // ç•™è¨€åŠŸèƒ½
        function addVisitor() {
            const name = document.getElementById('visitorName').value;
            const message = document.getElementById('visitorMessage').value;
            visitorManager.addVisitor(name, message);
        }
        
        function clearAllVisitors() {
            visitorManager.clearAllVisitors();
        }
        
        function copySiteLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                systemManager.showToast('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            });
        }
        
        // é€šçŸ¥åŠŸèƒ½
        function showNoticeForm() {
            document.getElementById('noticeForm').style.display = 'block';
        }
        
        function hideNoticeForm() {
            document.getElementById('noticeForm').style.display = 'none';
        }
        
        function addNotice() {
            const title = document.getElementById('noticeTitle').value;
            const content = document.getElementById('noticeContent').value;
            notificationManager.addNotice(title, content);
        }
        
        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            // ç§»é™¤æ‰€æœ‰tabçš„activeç±»
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰tab-contentçš„activeç±»
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // æ·»åŠ å½“å‰tabå’Œcontentçš„activeç±»
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        
        // æ»šåŠ¨åˆ°é¡¶éƒ¨
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // åˆå§‹åŒ–æ»šåŠ¨æŒ‰é’®
        function initScrollButton() {
            window.addEventListener('scroll', function() {
                const btn = document.getElementById('scrollTopBtn');
                btn.style.display = window.scrollY > 300 ? 'block' : 'none';
            });
        }
        
        // ä¸‹é›ªæ•ˆæœ
        function createSnowflakes() {
            const snowflakesContainer = document.getElementById('snowflakes');
            const snowflakeCount = 50;
            
            for (let i = 0; i < snowflakeCount; i++) {
                setTimeout(() => {
                    const snowflake = document.createElement('div');
                    snowflake.className = 'snowflake';
                    snowflake.innerHTML = 'â„';
                    
                    // éšæœºå¤§å°
                    const size = Math.random() * 20 + 10;
                    snowflake.style.fontSize = size + 'px';
                    
                    // éšæœºä½ç½®
                    const startX = Math.random() * 100;
                    snowflake.style.left = startX + 'vw';
                    
                    // éšæœºåŠ¨ç”»æ—¶é•¿
                    const duration = Math.random() * 5 + 5;
                    snowflake.style.animationDuration = duration + 's';
                    
                    // éšæœºé€æ˜åº¦
                    snowflake.style.opacity = Math.random() * 0.5 + 0.3;
                    
                    snowflakesContainer.appendChild(snowflake);
                    
                    // ç§»é™¤é›ªèŠ±
                    setTimeout(() => {
                        snowflake.remove();
                    }, duration * 1000);
                }, i * 200);
            }
        }
        
        // å¾ªç¯ä¸‹é›ªæ•ˆæœ
        function startSnowEffect() {
            createSnowflakes();
            setInterval(createSnowflakes, 10000); // æ¯10ç§’é‡æ–°åˆ›å»ºé›ªèŠ±
        }
        
        // ================================================
        // ã€é¡µé¢åˆå§‹åŒ–ã€‘
        // ================================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ CSSåŠ¨ç”»
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            // å›è½¦é”®ç™»å½•æ”¯æŒ
            document.getElementById('loginUsername')?.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('loginPassword').focus();
                }
            });
            
            document.getElementById('loginPassword')?.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') checkLogin();
            });
            
            // åˆå§‹åŒ–å½“å‰å¹´ä»½
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // å¼€å§‹ä¸‹é›ªæ•ˆæœ
            startSnowEffect();
        });
    </script>
</body>
</html>
